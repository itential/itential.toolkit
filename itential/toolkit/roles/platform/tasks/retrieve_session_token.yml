# Copyright (c) 2024, Itential, Inc
# GNU General Public License v3.0+ (see LICENSE or https://www.gnu.org/licenses/gpl-3.0.txt)
---
- name: Retrieve IAP session token
  itential.toolkit.iap_get_session_token:
    username: "{{ iap_username }}"
    password: "{{ iap_password }}"
    platform_base_url: "{{ platform_base_url }}"
  register: token_result

- name: Set IAP token variable
  ansible.builtin.set_fact:
    iap_token: "{{ token_result.token }}"
